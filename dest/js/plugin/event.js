define(function(require,exports){var a=function(a){return"[object Function]"===Object.prototype.toString.call(a)},b=function(a){return"[object Number]"===Object.prototype.toString.call(a)},c=function(b){var c=this,d=Object.keys(c).filter(function(b){return"length"!==b&&!a(c[b])});return c[d[b]]},d=function(){[].slice.call(arguments).forEach(function(b){for(var c in b)b.hasOwnProperty(c)&&!a(b[c])&&delete b[c]})},e=function(a,b){var c=Math.atan(Math.abs(b/a))/Math.PI*180;return 0>=a&&0>=b?c=180-c:0>=a&&b>=0?c+=180:a>=0&&b>=0&&(c=360-c),c},f=function(a){a.__bind_custom_event=!0;var f={target:null,startStamp:0,endStamp:0,startX:{},startY:{},endX:{},endY:{},diffX:{},diffY:{},startApart:0,endApart:0,startAngle:0,endAngle:0};f.startX.keys=c,f.startY.keys=c,f.endX.keys=c,f.endY.keys=c,f.diffX.keys=c,f.diffY.keys=c;var g=function(c){switch(f.target=c.target,c.type){case"touchstart":if(d(f.startX,f.startY,f.diffX,f.diffY),[].slice.call(c.touches).forEach(function(a,b){var c=a.identifier||b;f.startX[c]=f.endX[c]=a.clientX,f.startY[c]=f.endY[c]=a.clientY}),f.startX.length=c.touches.length,f.startY.length=c.touches.length,f.startStamp=f.endStamp=Date.now(),c.touches.length>1){var g=f.startX.keys(1)-f.startX.keys(0),h=f.startY.keys(1)-f.startY.keys(0);f.startApart=Math.sqrt(g*g+h*h),f.startAngle=e(g,h)}break;case"touchmove":if([].slice.call(c.touches).forEach(function(a,c){var d=a.identifier||c;f.endX[d]=a.clientX,f.endY[d]=a.clientY,b(f.startX[d])&&(f.diffX[d]=f.endX[d]-f.startX[d]),b(f.startY[d])&&(f.diffY[d]=f.endY[d]-f.startY[d])}),f.endX.length=f.endY.length=f.diffX.length=f.diffY.length=c.touches.length,c.touches.length>1){var i=f.endX.keys(1)-f.endX.keys(0),j=f.endY.keys(1)-f.endY.keys(0);f.endApart=Math.sqrt(i*i+j*j),f.endAngle=e(i,j)}a.trigger("swipe",f,c);break;case"touchcancel":case"touchend":f.endStamp=Date.now(),d(f.endX,f.endY),[].slice.call(c.changedTouches).forEach(function(b,d){var e=b.identifier||d;Math.abs(f.diffX[e])>30||Math.abs(f.diffY[e])>30?(a.trigger("swipeEnd",f,c),Math.abs(f.diffX[e])<Math.abs(f.diffY[e])&&f.diffY[e]<0?a.trigger("swipeUp",f,c):Math.abs(f.diffX[e])<Math.abs(f.diffY[e])&&f.diffY[e]>0?a.trigger("swipeDown",f,c):Math.abs(f.diffX[e])>Math.abs(f.diffY[e])&&f.diffX[e]<0?a.trigger("swipeLeft",f,c):Math.abs(f.diffX[e])>Math.abs(f.diffY[e])&&f.diffX[e]>0&&a.trigger("swipeRight",f,c)):(a.trigger("tap",f,c),f.endStamp-f.startStamp>500&&a.trigger("longTap",f,c))})}};a.addEventListener("touchstart",g,!1),a.addEventListener("touchmove",g,!1),a.addEventListener("touchend",g,!1),a.addEventListener("touchcancel",g,!1)},g=Element.prototype.addEventListener;Element.prototype.addEventListener=Element.prototype.on=function(a){return h.indexOf(a)>-1&&!this.__bind_custom_event&&f(this),g.apply(this,arguments),this},Element.prototype.trigger=function(a,b,c){var d=document.createEvent("HTMLEvents");if(d.initEvent(a,!0,!0),d.data=b||{},d.eventName=a,d.target=this,c&&c instanceof Event){var e=d.preventDefault,f=d.stopPropagation;d.preventDefault=function(){c.preventDefault(),e.apply(d,arguments)},d.stopPropagation=function(){c.stopPropagation(),f.apply(d,arguments)}}return this.dispatchEvent(d),this};var h=["tap","longTap","swipe","swipeEnd","swipeLeft","swipeRight","swipeUp","swipeDown"],i=Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector;Element.prototype.live=function(a,b,c){var d=this,e=function(e){var f=e.target;h.indexOf(a)>-1&&f===d&&e.data&&e.data.target&&(f=e.data.target);for(var g=i.call(f,b);!g&&f.parentNode&&f!==d;)f=f.parentNode,g=i.call(f,b);g&&c.call(f,e)};return d.addEventListener(a,e,!1),d}});