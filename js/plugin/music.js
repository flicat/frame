define(function(require,exports){var a=function(a,b,c){var d=function(e){a.removeEventListener(b,d,!1),c.call(this,e)};a.addEventListener(b,d,!1)},b=/i(Phone|P(o|a)d)/.test(navigator.userAgent),c=Number(sessionStorage.music_current_time)||0,d=sessionStorage.music_play_state,e=function(){var a=document.createElement("i");return a.className="icon-music",document.body.appendChild(a),a};return function(f,g,h){var i=!1,j=new Audio(f);j.loop=!!g,j.autoplay=!1;var k=e(),l=function(){i=!0,j.play()},m=function(){i=!1,j.pause()},n=function(){i=!1,j.pause(),j.previousTime=0,j.currentTime=0},o=function(){k.classList.add("icon-music-animation")},p=function(){k.classList.remove("icon-music-animation")},q=function(){c?b?j.previousTime=c:j.currentTime=c:null};return j.addEventListener("playing",o,!1),j.addEventListener("ended",p,!1),j.addEventListener("pause",p,!1),j.addEventListener("loadeddata",q,!1),d&&"play"!==d||!h||(l(),b&&a(document,"touchstart",l)),k.addEventListener("touchend",function(a){a.stopPropagation(),a.preventDefault(),sessionStorage.music_play_state=i?"stop":"play",i?n():l()},!1),window.addEventListener("beforeunload",function(){b?sessionStorage.music_current_time=j.previousTime:sessionStorage.music_current_time=j.currentTime,j.pause(),j=null}),{play:l,pause:m,stop:n}}});